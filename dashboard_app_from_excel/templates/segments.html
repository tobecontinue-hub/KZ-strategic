{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
{% set core_segments = data | selectattr('Section', 'equalto', 'Core Segments') | list %}
{% set new_segments = data | selectattr('Section', 'equalto', 'New Segments') | list %}
{% set insights = data | selectattr('Section', 'equalto', 'Insight') | list %}
<style>
:root {
  --seg-bg: #020617;
  --seg-card: rgba(15,23,42,0.78);
  --seg-border: rgba(148,163,184,0.3);
  --seg-highlight: #34d399;
  --seg-secondary: #818cf8;
}

.segments-shell {
  min-height: calc(100vh - 120px);
  background: radial-gradient(circle at top, rgba(52,211,153,0.10), rgba(15,23,42,0.95));
  padding: 40px 12px 80px;
}

.segments-card {
  max-width: 1200px;
  margin: 0 auto;
  background: rgba(2,6,23,0.9);
  border-radius: 36px;
  border: 1px solid rgba(148,163,184,0.25);
  box-shadow: 0 45px 130px rgba(2,6,23,0.85);
  overflow: hidden;
}

.seg-hero {
  padding: 36px 40px 30px;
  border-bottom: 1px solid rgba(148,163,184,0.2);
  background: linear-gradient(135deg, rgba(52,211,153,0.2), rgba(79,70,229,0.25));
  color: #f8fafc;
}

.seg-hero h1 {
  font-size: clamp(2.1rem, 3vw, 2.9rem);
  font-weight: 800;
  margin-bottom: 12px;
}

.seg-hero p {
  max-width: 820px;
  color: #cbd5f5;
  margin-bottom: 24px;
}

.seg-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(200px,1fr));
  gap: 16px;
}

.stat-panel {
  border-radius: 20px;
  border: 1px solid rgba(148,163,184,0.25);
  padding: 16px 18px;
  background: rgba(15,23,42,0.65);
}

.stat-panel label {
  text-transform: uppercase;
  letter-spacing: 0.18em;
  color: #a5b4fc;
  font-size: 0.78rem;
}

.stat-panel span {
  display: block;
  font-size: 2rem;
  font-weight: 700;
  color: #ecfccb;
}

.seg-body {
  padding: 36px 40px 50px;
  display: grid;
  gap: 30px;
}

.segment-group-title {
  font-size: 1rem;
  letter-spacing: 0.38em;
  text-transform: uppercase;
  color: #cbd5f5;
  margin-bottom: 12px;
}

.segment-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 22px;
}

.segment-beam {
  border-radius: 26px;
  border: 1px solid var(--seg-border);
  background: var(--seg-card);
  padding: 24px 22px 26px;
  position: relative;
  overflow: hidden;
}

.segment-beam::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  border: 1px solid transparent;
  background: linear-gradient(120deg, rgba(52,211,153,0.4), rgba(99,102,241,0.4));
  opacity: 0;
  transition: opacity 0.3s ease;
}
.segment-beam:hover::before { opacity: 1; }
.segment-beam > * { position: relative; z-index: 1; }

.segment-chip {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 6px 14px;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.35);
  color: #cbd5f5;
  text-transform: uppercase;
  letter-spacing: 0.2em;
  font-size: 0.7rem;
}

.segment-name {
  font-size: 1.4rem;
  font-weight: 700;
  color: #f8fafc;
  margin: 14px 0 18px;
}

.segment-columns {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
}

.segment-column {
  background: rgba(15,23,42,0.65);
  border: 1px solid rgba(148,163,184,0.25);
  border-radius: 18px;
  padding: 12px 14px 14px;
}

.column-title {
  font-size: 0.78rem;
  text-transform: uppercase;
  letter-spacing: 0.16em;
  color: #93c5fd;
  margin-bottom: 8px;
}

.column-list {
  margin: 0;
  padding-left: 18px;
  color: #cbd5f5;
  font-size: 0.92rem;
  line-height: 1.4;
}

.column-list li { margin-bottom: 6px; }

.insight-card {
  border-radius: 28px;
  border: 1px solid rgba(248,250,252,0.4);
  background: rgba(15,118,110,0.15);
  padding: 26px;
  color: #ecfeff;
}

.insight-card h4 {
  font-size: 1.2rem;
  font-weight: 700;
  margin-bottom: 10px;
}

@media (max-width: 768px) {
  .seg-hero, .seg-body { padding: 26px; }
}
</style>

<div class="segments-shell">
  <div class="segments-card">
    <section class="seg-hero">
      <p class="text-uppercase" style="letter-spacing:0.32em; color:#a5f3fc; font-weight:600; font-size:0.85rem;">Segments v2</p>
      <h1>Clarity on the customers we anchor, explore, and learn from.</h1>
      <p>Elegant view of our core believers, emerging bets, and qualitative signals worth sharing in the next briefing.</p>
      <div class="seg-stats">
        <div class="stat-panel">
          <label>Core Segments</label>
          <span>{{ core_segments|length }}</span>
        </div>
        <div class="stat-panel">
          <label>New Segments</label>
          <span>{{ new_segments|length }}</span>
        </div>
        <div class="stat-panel">
          <label>Insight Notes</label>
          <span>{{ insights|length }}</span>
        </div>
      </div>
    </section>

    <section class="seg-body">
      {% if core_segments %}
      <div>
        <div class="segment-group-title">Core Segments</div>
        <div class="segment-grid">
          {% for row in core_segments %}
          <article class="segment-beam">
            <span class="segment-chip"><i class="bi bi-shield-check"></i> Core</span>
            <div class="segment-name">{{ row['Segment'] }}</div>
            <div class="segment-columns">
              {% for label, field in [
                ('Who they are', 'Who they are'),
                ('Where they are', 'Where they are'),
                ('Why', 'Why'),
                ('Priority rationale', 'Priority Rationale')
              ] %}
              <div class="segment-column">
                <div class="column-title">{{ label }}</div>
                <ul class="column-list">
                  {% for line in (row[field] or '').split('\n') %}
                    {% if line.strip() %}
                      <li>{{ line.strip() }}</li>
                    {% endif %}
                  {% endfor %}
                </ul>
              </div>
              {% endfor %}
            </div>
          </article>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      {% if new_segments %}
      <div>
        <div class="segment-group-title">New Segments</div>
        <div class="segment-grid">
          {% for row in new_segments %}
          <article class="segment-beam">
            <span class="segment-chip" style="border-color:rgba(244,114,182,0.4); color:#fbcfe8;"><i class="bi bi-rocket-takeoff"></i> New</span>
            <div class="segment-name">{{ row['Segment'] }}</div>
            <div class="segment-columns">
              {% for label, field in [
                ('Who they are', 'Who they are'),
                ('Where they are', 'Where they are'),
                ('Why', 'Why'),
                ('Priority rationale', 'Priority Rationale')
              ] %}
              <div class="segment-column">
                <div class="column-title">{{ label }}</div>
                <ul class="column-list">
                  {% for line in (row[field] or '').split('\n') %}
                    {% if line.strip() %}
                      <li>{{ line.strip() }}</li>
                    {% endif %}
                  {% endfor %}
                </ul>
              </div>
              {% endfor %}
            </div>
          </article>
          {% endfor %}
        </div>
      </div>
      {% endif %}

      {% if insights %}
      <div>
        <div class="segment-group-title">Field Insight</div>
        <div class="segment-grid">
          {% for row in insights %}
          <article class="segment-beam" style="background:rgba(15,118,110,0.3); border-color:rgba(16,185,129,0.4);">
            <span class="segment-chip" style="border-color:rgba(16,185,129,0.4); color:#bbf7d0;"><i class="bi bi-chat-dots"></i> Insight</span>
            <div class="segment-name">{{ row['Segment'] }}</div>
            <div class="insight-card">
              <h4>What we see</h4>
              <p class="mb-0" style="line-height:1.6;">{{ row['Who they are'] }}</p>
            </div>
          </article>
          {% endfor %}
        </div>
      </div>
      {% endif %}
    </section>
  </div>
</div>
{% endblock %}
