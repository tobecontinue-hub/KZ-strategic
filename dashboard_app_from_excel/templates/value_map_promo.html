<!-- templates/value_map_promo.html -->
{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<style>
:root {
  --vm-bg: #020617;
  --vm-card: rgba(15,23,42,0.82);
  --vm-border: rgba(148,163,184,0.28);
  --vm-highlight: #fb7185;
}

.value-shell {
  min-height: calc(100vh - 120px);
  background: radial-gradient(circle at top, rgba(251,113,133,0.18), rgba(15,23,42,0.95));
  padding: 40px 12px 70px;
}

.value-board {
  max-width: 1250px;
  margin: 0 auto;
  border-radius: 36px;
  border: 1px solid rgba(244,114,182,0.35);
  box-shadow: 0 50px 140px rgba(2,6,23,0.9);
  background: rgba(2,6,23,0.92);
  overflow: hidden;
}

.value-hero {
  padding: 36px 42px 30px;
  color: #f8fafc;
  background: linear-gradient(135deg, rgba(251,113,133,0.22), rgba(244,114,182,0.25));
}

.value-hero h1 {
  font-size: clamp(2.1rem, 3vw, 2.8rem);
  font-weight: 800;
  margin-bottom: 12px;
}

.value-hero p {
  color: #fbcfe8;
  max-width: 820px;
  margin-bottom: 20px;
}

.value-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 14px;
}

.stat-card {
  border-radius: 20px;
  border: 1px solid rgba(248,113,113,0.35);
  padding: 14px 16px;
  background: rgba(80,7,36,0.55);
}

.stat-card label {
  font-size: 0.75rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: #fecdd3;
}

.stat-card span {
  display: block;
  font-size: 1.7rem;
  font-weight: 700;
  color: #ffe4e6;
}

.value-body {
  padding: 36px 42px 48px;
  display: grid;
  gap: 26px;
}

.value-section {
  border-radius: 28px;
  border: 1px solid var(--vm-border);
  background: var(--vm-card);
  padding: 20px 24px 24px;
}

.section-header {
  display: flex;
  flex-wrap: wrap;
  gap: 14px;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 18px;
}

.section-title {
  display: flex;
  align-items: center;
  gap: 12px;
  color: #f8fafc;
}

.section-title i {
  font-size: 1.4rem;
  color: #fb7185;
}

.section-title h3 {
  margin: 0;
  font-size: 1.4rem;
  font-weight: 700;
}

.section-toggle {
  border-radius: 999px;
  border: 1px solid rgba(248,113,113,0.4);
  background: rgba(80,7,36,0.6);
  color: #fecdd3;
  padding: 6px 14px;
  text-transform: uppercase;
  font-size: 0.75rem;
  letter-spacing: 0.2em;
  cursor: pointer;
}

.section-body {
  display: none;
}
.section-body.show {
  display: grid;
  gap: 16px;
}

.dataset-card {
  border-radius: 22px;
  border: 1px solid rgba(248,113,113,0.25);
  background: rgba(76,5,25,0.6);
  padding: 18px 20px;
}

.dataset-card h4 {
  margin: 0 0 10px;
  color: #ffe4e6;
  font-size: 1.05rem;
}

.dataset-rows {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 10px;
}

.dataset-cell {
  border-radius: 16px;
  border: 1px solid rgba(248,113,113,0.25);
  background: rgba(2,6,23,0.6);
  padding: 10px 12px;
}

.dataset-cell label {
  font-size: 0.68rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: #fecdd3;
}

.dataset-cell p {
  margin: 6px 0 0;
  color: #ffe4e6;
  font-size: 0.9rem;
  line-height: 1.4;
}

.activity-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 16px;
}

.activity-card {
  border-radius: 20px;
  border: 1px solid rgba(248,166,212,0.4);
  background: rgba(190,24,93,0.35);
  color: #fff1f2;
  padding: 18px;
}

.activity-card h5 { margin: 0 0 8px; font-weight: 700; }
.activity-card p { margin: 0; line-height: 1.5; }

@media (max-width: 768px) {
  .value-hero, .value-body { padding: 26px; }
}
</style>

<div class="value-shell">
  <div class="value-board">
    <section class="value-hero">
      <p class="text-uppercase" style="letter-spacing:0.28em; color:#ffe4e6; font-weight:600; font-size:0.85rem;">Promo Value Map</p>
      <h1>Promo pains, levers, and execution cards on one canvas.</h1>
      <p>Updated matrix for campaign-season priorities. Use the collapsibles to drill into each bucket.</p>
      <div class="value-stats">
        <div class="stat-card"><label>Pains</label><span>{{ pains|length }}</span></div>
        <div class="stat-card"><label>Relievers</label><span>{{ relievers|length }}</span></div>
        <div class="stat-card"><label>Gains</label><span>{{ gains|length }}</span></div>
        <div class="stat-card"><label>Creators</label><span>{{ creators|length }}</span></div>
        <div class="stat-card"><label>Products</label><span>{{ products|length }}</span></div>
        <div class="stat-card"><label>Services</label><span>{{ services|length }}</span></div>
        <div class="stat-card"><label>Demo & Geo</label><span>{{ demo|length }}</span></div>
        <div class="stat-card"><label>JTBD</label><span>{{ justtobedone|length }}</span></div>
      </div>
    </section>

    <section class="value-body">
      {% macro render_section(title, icon, dataset) -%}
        {% if dataset %}
        <article class="value-section">
          <div class="section-header">
            <div class="section-title">
              <i class="bi {{ icon }}"></i>
              <h3>{{ title }}</h3>
            </div>
            <button class="section-toggle" onclick="toggleValueSection(this)">Expand</button>
          </div>
          <div class="section-body">
            {% for item in dataset %}
            <div class="dataset-card">
              {% set first = namespace(label='Item', value='') %}
              {% for key, value in item.items() %}
                {% if value and key not in ['Content_Category', 'Content_Area'] and not first.value %}
                  {% set first.label = key.replace('_',' ') %}
                  {% set first.value = value %}
                {% endif %}
              {% endfor %}
              <h4>{{ first.label }} â€” {{ first.value }}</h4>
              <div class="dataset-rows">
                {% for key, value in item.items() %}
                  {% if value and key not in ['Content_Category', 'Content_Area'] %}
                    <div class="dataset-cell">
                      <label>{{ key.replace('_',' ') }}</label>
                      <p>{{ value }}</p>
                    </div>
                  {% endif %}
                {% endfor %}
              </div>
            </div>
            {% endfor %}
          </div>
        </article>
        {% endif %}
      {%- endmacro %}

      {{ render_section('Customer Pains', 'bi-exclamation-triangle', pains) }}
      {{ render_section('Pain Relievers', 'bi-check-circle', relievers) }}
      {{ render_section('Gain Points', 'bi-star', gains) }}
      {{ render_section('Gain Creators', 'bi-lightning-charge', creators) }}
      {{ render_section('Products', 'bi-box', products) }}
      {{ render_section('Services', 'bi-tools', services) }}
      {{ render_section('Demo / Geo', 'bi-people', demo) }}
      {{ render_section('Jobs To Be Done', 'bi-clipboard-check', justtobedone) }}

      {% if activities %}
      <article class="value-section">
        <div class="section-header">
          <div class="section-title">
            <i class="bi bi-gear"></i>
            <h3>Key Activities</h3>
          </div>
        </div>
        <div class="activity-grid">
          {% for item in activities %}
          <div class="activity-card">
            <h5>{{ item['Value/Headline'] }}</h5>
            <p>{{ item['Details/Rationale'] }}</p>
          </div>
          {% endfor %}
        </div>
      </article>
      {% endif %}
    </section>
  </div>
</div>

<script>
function toggleValueSection(btn) {
  const body = btn.parentElement.nextElementSibling;
  body.classList.toggle('show');
  btn.textContent = body.classList.contains('show') ? 'Collapse' : 'Expand';
}
</script>
{% endblock %}
