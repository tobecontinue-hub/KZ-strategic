<!-- templates/swot.html -->
{% extends "base.html" %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
{% set categories = sections.keys() | list %}
<style>
:root {
  --swot-bg: #010a16;
  --swot-surface: rgba(15,23,42,0.82);
  --swot-border: rgba(148,163,184,0.28);
  --swot-highlight: #38bdf8;
}

.swot-stage {
  background: radial-gradient(circle at top, rgba(56,189,248,0.22), rgba(15,23,42,0.95));
  min-height: calc(100vh - 120px);
  padding: 40px 16px 60px;
}

.swot-shell {
  max-width: 1220px;
  margin: 0 auto;
  border-radius: 40px;
  border: 1px solid rgba(56,189,248,0.3);
  box-shadow: 0 45px 130px rgba(2,6,23,0.9);
  overflow: hidden;
  background: rgba(2,6,23,0.9);
}

.swot-hero {
  padding: 36px 42px 28px;
  background: linear-gradient(135deg, rgba(59,130,246,0.28), rgba(248,113,113,0.25));
  color: #f8fafc;
}

.swot-hero h1 {
  font-size: clamp(2.1rem, 3vw, 2.8rem);
  font-weight: 800;
  margin-bottom: 12px;
}

.swot-hero p {
  color: #cbd5f5;
  max-width: 760px;
  margin-bottom: 18px;
}

.swot-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
  gap: 16px;
}

.stat-pill {
  border-radius: 20px;
  border: 1px solid rgba(148,163,184,0.3);
  padding: 14px 16px;
  background: rgba(15,23,42,0.7);
}

.stat-pill label {
  font-size: 0.75rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: #cfd8ff;
}

.stat-pill span {
  display: block;
  font-size: 1.8rem;
  font-weight: 700;
  color: #f0fdf4;
}

.swot-body {
  padding: 36px 42px 46px;
}

.filter-bar {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 24px;
}

.filter-chip {
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.3);
  padding: 7px 18px;
  background: rgba(15,23,42,0.55);
  color: #cbd5f5;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.filter-chip.active {
  background: rgba(56,189,248,0.25);
  border-color: rgba(56,189,248,0.5);
  color: #f8fafc;
  box-shadow: 0 12px 30px rgba(56,189,248,0.25);
}

.swot-layout {
  display: grid;
  grid-template-columns: minmax(0, 3fr) minmax(0, 1.2fr);
  gap: 26px;
}

@media (max-width: 992px) {
  .swot-layout { grid-template-columns: minmax(0, 1fr); }
  .swot-hero, .swot-body { padding: 26px; }
}

.swot-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 18px;
}

.swot-card {
  border-radius: 26px;
  border: 1px solid var(--swot-border);
  background: var(--swot-surface);
  padding: 20px 22px 22px;
  position: relative;
  overflow: hidden;
}

.swot-card::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  border: 1px solid transparent;
  background: linear-gradient(120deg, rgba(56,189,248,0.4), rgba(244,114,182,0.4));
  opacity: 0;
  transition: opacity 0.3s ease;
}
.swot-card:hover::after { opacity: 1; }
.swot-card > * { position: relative; z-index: 1; }

.swot-tag {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 6px 14px;
  border-radius: 999px;
  border: 1px solid rgba(148,163,184,0.4);
  font-size: 0.7rem;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: #f8fafc;
}

.swot-title {
  font-size: 1.1rem;
  font-weight: 700;
  color: #f8fafc;
  margin: 14px 0 6px;
}

.swot-ref { color: #94a3b8; font-size: 0.8rem; letter-spacing: 0.3em; text-transform: uppercase; }

.swot-details {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 10px;
  margin-top: 14px;
}

.swot-detail {
  border-radius: 16px;
  border: 1px solid rgba(148,163,184,0.25);
  background: rgba(15,23,42,0.75);
  padding: 12px 14px;
}

.swot-detail label {
  display: block;
  font-size: 0.7rem;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: #bae6fd;
  margin-bottom: 6px;
}

.swot-detail p {
  margin: 0;
  color: #cbd5f5;
  font-size: 0.92rem;
  line-height: 1.4;
}

.key-insight-panel {
  border-radius: 26px;
  background: rgba(67,56,202,0.35);
  border: 1px solid rgba(129,140,248,0.5);
  padding: 24px;
  color: #e0e7ff;
  box-shadow: inset 0 0 30px rgba(99,102,241,0.25);
}
.key-insight-panel h2 {
  font-size: 1.25rem;
  font-weight: 700;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 10px;
}
.key-insight-panel ul { padding-left: 18px; margin: 0; }
.key-insight-panel li { margin-bottom: 8px; line-height: 1.5; }

</style>

<div class="swot-stage">
  <div class="swot-shell">
    <div class="swot-hero">
      <p class="text-uppercase" style="letter-spacing:0.32em; color:#fcd34d; font-weight:600; font-size:0.85rem;">SWOT Board</p>
      <h1>Strategic posture: strengths we scale, threats we neutralize.</h1>
      <p>Unified board for the latest SWOT signals. Tap filters to isolate what matters for your review.</p>
      <div class="swot-stats">
        <div class="stat-pill">
          <label>Total Entries</label>
          <span>{{ sections | map('length') | sum }}</span>
        </div>
        {% for cat in categories %}
        <div class="stat-pill">
          <label>{{ cat }}</label>
          <span>{{ sections[cat]|length }}</span>
        </div>
        {% endfor %}
      </div>
    </div>

    <div class="swot-body">
      <div class="filter-bar" id="swotFilter">
        <button class="filter-chip active" data-filter="all">All</button>
        {% for category in categories %}
        <button class="filter-chip" data-filter="{{ category }}">{{ category }}</button>
        {% endfor %}
      </div>

      <div class="swot-layout">
        <div class="swot-grid" id="swotGrid">
          {% for category, entries in sections.items() %}
            {% for entry in entries %}
              {% set cat = category|lower %}
              {% set color = '#38bdf8' %}
              {% if 'strength' in cat %}
                {% set color = '#4ade80' %}
              {% elif 'weak' in cat %}
                {% set color = '#f87171' %}
              {% elif 'opportun' in cat %}
                {% set color = '#38bdf8' %}
              {% elif 'threat' in cat %}
                {% set color = '#fbbf24' %}
              {% endif %}
              <article class="swot-card" data-category="{{ category }}">
                <span class="swot-tag" style="border-color: {{ color }}; color: {{ color }};">
                  <i class="bi bi-record-fill" style="font-size:0.7rem;"></i>
                  {{ category }}
                </span>
                <div class="swot-title">{{ entry.title or 'Untitled Item' }}</div>
                <div class="swot-ref">Ref â€¢ {{ entry.id or 'N/A' }}</div>
                <div class="swot-details">
                  <div class="swot-detail">
                    <label>2025 Insight</label>
                    <p>{{ entry.details_2025 or 'N/A' }}</p>
                  </div>
                  <div class="swot-detail">
                    <label>2026 Strategy</label>
                    <p>{{ entry.details_2026 or 'N/A' }}</p>
                  </div>
                </div>
              </article>
            {% endfor %}
          {% endfor %}
        </div>

        {% if key_insights %}
        <aside class="key-insight-panel">
          <h2><i class="bi bi-lightbulb"></i> Key Insight Stream</h2>
          <ul>
            {% for insight in key_insights %}
            <li><strong>{{ insight.title or 'Insight' }}:</strong> {{ insight.content }}</li>
            {% endfor %}
          </ul>
        </aside>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<script>
const filterChips = document.querySelectorAll('#swotFilter .filter-chip');
const cards = document.querySelectorAll('#swotGrid .swot-card');
filterChips.forEach(chip => {
  chip.addEventListener('click', () => {
    filterChips.forEach(c => c.classList.remove('active'));
    chip.classList.add('active');
    const filter = chip.dataset.filter;
    cards.forEach(card => {
      const match = filter === 'all' || card.dataset.category === filter;
      card.style.display = match ? 'block' : 'none';
      if (match) {
        card.style.animation = 'fadeUp .4s ease';
      }
    });
  });
});
</script>
{% endblock %}
